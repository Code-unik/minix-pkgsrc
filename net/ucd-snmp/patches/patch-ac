$NetBSD$

--- apps/snmpnetstat/if.c.orig	Fri Nov 16 11:54:02 2001
+++ apps/snmpnetstat/if.c	Wed Feb 13 17:29:05 2002
@@ -279,6 +279,11 @@
 		    case IFINDEX:
 			ifindex = *var->val.integer;
 			for (cur_if = if_table; cur_if->ifindex != ifindex && cur_if->ifindex != 0; cur_if++) ;
+			if (cur_if >= (if_table + cfg_nnets))
+			{
+				fprintf (stderr, "Inconsistent reponse from server. Aborting\n");
+				exit (0);
+			}
 			cur_if->ifindex = ifindex;
 			break;
 		    case OUTQLEN:
