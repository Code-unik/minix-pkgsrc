$NetBSD$

--- src/msmtp.c.orig	2005-08-14 20:13:02.000000000 +0000
+++ src/msmtp.c
@@ -31,7 +31,6 @@
 #include <string.h>
 #include <ctype.h>
 #include <errno.h>
-extern int errno;
 #include <time.h>
 #include <getopt.h>
 extern char *optarg;
@@ -3382,5 +3381,5 @@ exit:
 	list_xfree(errmsg, free);
     }
 
-    return error_code;
+    return (error_code == EX_OK) ? 0 : error_code;
 }
