$NetBSD$

--- models/upscommon.c.orig	Fri May 17 15:27:55 2002
+++ models/upscommon.c
@@ -688,6 +688,11 @@ void info_ready(void)
 {
 	int	ret;
 
+#ifdef HAVE_MMAP
+	/* sync external file representation before operating on the file */
+	msync(shared_info, info_size, MS_INVALIDATE);
+#endif
+
 	ret = rename(initfn, statefn);
 
 	if (ret != 0)
