$NetBSD$

--- infback.c.orig	Mon Aug 11 16:48:06 2003
+++ infback.c
@@ -434,6 +434,9 @@ void FAR *out_desc;
                 }
             }
 
+            if (state->mode == BAD)
+                break;
+
             /* build code tables */
             state->next = state->codes;
             state->lencode = (code const FAR *)(state->next);
